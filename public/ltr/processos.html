<!-- saved from url=(0014)about:i
  nternet -->
<!-- Page Header -->
<link href="/assets/plugins/prism/prism.css" rel="stylesheet">
<div class="page-header">
    <div>
      <h2 class="main-content-title tx-24 mg-b-5">Processos</h2>
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="accordion.html#">Menu</a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">Processos</li>
      </ol>
    </div>
    <!-- <div class="d-flex">
      <div class="justify-content-center">
        <button type="button" class="btn btn-white btn-icon-text my-2 mr-2">
          <i class="fe fe-download mr-2"></i> Import </button>
        <button type="button" class="btn btn-white btn-icon-text my-2 mr-2">
          <i class="fe fe-filter mr-2"></i> Filter </button>
        <button type="button" class="btn btn-primary my-2 btn-icon-text">
          <i class="fe fe-download-cloud mr-2"></i> Download Report </button>
      </div>
    </div> -->
  </div>
  <!-- End Page Header -->
  <!-- Row -->
  <div class="row row-sm">
    <div class="col-lg-12 col-xl-12 col-md-12">
        <div class="card custom-card">
            <div class="card-body" style="padding-bottom: 0px;">
                <label><strong>Filtros</strong></label>
              <form id="form_pesquisa">
                  <!-- <div class="row">
                    <div class="col-md-3">
                        <div class="form-group"> 
                            <p class="mg-b-10">Referencia</p>
                            <input type="text" class="form-control" name="example-text-input" placeholder="Referencia"> 
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group"> 
                            <p class="mg-b-10">Origem</p>
                            <input type="text" class="form-control" name="example-text-input" placeholder="Referencia"> 
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group"> 
                            <p class="mg-b-10">Destino</p>
                            <input type="text" class="form-control" name="example-text-input" placeholder="Referencia"> 
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group"> 
                            <p class="mg-b-10">Navio/Viagem</p>
                            <input type="text" class="form-control" name="example-text-input" placeholder="Referencia"> 
                        </div>
                    </div>
                  </div> -->


                
                  <div class="row">
                    <style>
                        .form_pesquisa .col-md-2{
                          flex: 0 0 10.66667% !important;
                        }
                    </style>
                    <div class="input-group col-12 form_pesquisa">
                   
               
                            <div class="col-md-1" style="margin-top: 34px;">
                                <label class="rdiobox" style="margin-top: 10px;">
                                    <input name="tipo_filtro" value="Abertura" type="radio"> <span>Abertura</span>
                                </label>
                                <label class="rdiobox" style="margin-top: 10px;">
                                
                                </label>
                                <label class="rdiobox" style="margin-top: 20px;">
                                    <input name="tipo_filtro" value="Pagamento"  type="radio"> <span>Pagamento</span>
                                </label>
                            </div>
                            <div class="col-md-1" style="margin-top: 34px;">
                                <label class="rdiobox" style="margin-top: 10px;">
                                    <input name="tipo_filtro" value="ETA" type="radio"> <span>ETA</span>
                                    
                                </label>
                                <label class="rdiobox" style="margin-top: 10px;">
                                   
                                </label>
                                <label class="rdiobox" style="margin-top: 20px;">
                                    <input name="tipo_filtro" value="ETD" type="radio"> <span>ETD</span>
                                </label>
                            </div>
                           
                            <div class="col-md-2" style="padding-left: 0;border-right: 2px solid black;flex: 0 0 10.66667%;">
                                <div class="input-group" style="width: 155px;margin-top: 34px;"> 
                                    <div class="input-group-prepend"> 
                                            <div class="input-group-text" style="width: 51px;"> De: 
                                        </div> 
                                    </div> 
                                    <input type="text" class="form-control input-sm data_mask" name="data_de" placeholder="__/__/____"> 
                                </div>

                                <div class="input-group" style="width: 155px;margin-top: 19px;"> 
                                    <div class="input-group-prepend"> 
                                            <div class="input-group-text"> Até: 
                                        </div> 
                                    </div> 
                                    <input type="text" class="form-control input-sm data_mask" name="data_ate" placeholder="__/__/____"> 
                                </div>
                                
                              
                            </div>

                            <div class="col-md-2" style="margin-top: 6px;">
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;">Referencia</p>
                                 

                                    <select name="referencia" class="form-control select2-search ">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >Origem</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="origem" placeholder="Origem">  -->
                                    <select name="origem" class="form-control select2-search">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                
                            </div>

                            <div class="col-md-2" style="margin-top: 6px;">
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >Armador</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="armador" placeholder="Referencia">  -->
                                    <select name="armador" class="form-control select2-search">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >Destino</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="destino" placeholder="Referencia">  -->
                                    <select name="destino" class="form-control select2-search">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                
                            </div>

                            <div class="col-md-2" style="margin-top: 6px;">
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >Importador</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="importador" placeholder="Referencia">  -->
                                    <select name="importador" class="form-control select2-search">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >Navio/Viagem</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="navio_viagem" placeholder="Referencia">  -->
                                    <select name="navio_viagem" class="form-control select2-search">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                
                            </div>

                            <div class="col-md-2" style="margin-top: 6px;">
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >Exportador</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="exportador" placeholder="Referencia">  -->
                                    <select name="exportador" class="form-control select2-search">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >Status</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="status" placeholder="Referencia">  -->
                                    <select name="status" class="form-control select2-search">
                                      <option selected value="vazio"> ------ </option>
                                      <option  value="0"> Pré-processo </option>
                                      <option  value="1"> Ag. embarque </option>
                                      <option  value="2"> Embarcado </option>
                                      <option  value="3"> Desembarque </option>
                                      <option  value="4"> Cancelado </option>
                                      <option  value="5"> Pendente </option>
                                      <option  value="6"> Autorizado </option>
                                      <option  value="7"> Coletado </option>
                                      <option  value="8"> Entregue </option>
                                      <option  value="9"> Ag. prontidão </option>
                                      <option  value="10"> Ag. booking finalizado </option>
                                      <option  value="11"> Ag. coleta </option>
                                      <option  value="12"> Ag. entrega  </option>
                                   </select>
                                </div>
                                
                            </div>
                  
                            <div class="col-md-2" style="margin-top: 6px;">
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >Mercadoria</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="mercadoria" placeholder="Referencia">  -->
                                    <select name="mercadoria" class="form-control select2-search">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >Tipo carga</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="equipamento" placeholder="Referencia"> -->
                                    
                                    <select name="equipamento" class="form-control select2-search">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                
                            </div>

                            <div class="col-md-2" style="margin-top: 6px;">
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >HBL</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="hbl" placeholder="Referencia">  -->
                                    <select name="hbl" class="form-control select2-search">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                <div class="form-group" style="width: 132px;"> 
                                    <p class="mg-b-10" style="font-size: 13px;" >Booking</p>
                                    <!-- <input type="text" style="margin-top: -10px;" class="form-control input-sm" name="booking" placeholder="Referencia"> -->
                                    
                                    <select name="booking" class="form-control select2-search">
                                      <option selected value="0"> ------ </option>
                                   </select>
                                </div>
                                
                            </div>
                            

                           
                  
                  
                        
                 
                    </div>


                   
                  
                  </div>
                  <div class="row" style="margin-top: 10px;">
                    <div class="col-12" >
                      <button type="submit" style="width: 100%;height: 100%;" class="btn btn-ripple btn-primary btn-icon btn_filtro"> <i class="fe fe-search"></i></button>
                      </div>
                  </div>
             
                  
                
              </form>
            </div>
          </div>
    </div>
  </div>
  <div class="row row-sm">
    <div class="col-lg-12 col-xl-3 col-md-12">
        <div class="card custom-card">
          <div class="card-body" style="padding-bottom: 0px;height: 55px;">
            <form>
              <div class="form-group mb-0">
                <label><strong>Lista de Processos</strong></label>
               
              </div>
            </form>
          </div>
          <div class="card-body pt-1" >
            <input style="margin-top: 5px;" class="form-control" id="input_search" placeholder="Pesquisar" type="text">
            <div class="border" style="margin-top: 7px;">
              
              <div class="list-group projects-list lista_processos pt-0 pb-0 pl-0 pr-0" style="margin-bottom: 2px;overflow: auto;max-height: 750px;">
               

              </div>
            </div>
          </div>
        </div>
      </div>


      <div class="col-9">
        <div class="card custom-card page_processo">
         <div class="card-body" >
          <div class="error-bg">
            <!-- Row -->
            <div class="row sidemenu-height">
              <div class="col-md-12">
                <div class="construction1 text-center details">
                  <div class="row align-items-center">
                    <div class="col-lg-12">
                      <h1 class="tx-140 mb-0">←</h1>
                    </div>
                    <div class="col-lg-12 ">
                      <h1> Selecione um dos processos filtrados ao lado.</h1>
                      <h6 class="tx-15 mt-3 mb-4 text-muted">Você deve utilizar os filtros para a listagem dos processos.</h6>
                      <!-- <a class="btn ripple btn-success text-center" href="vertical.html">Back to Home</a> -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- End Row -->
          </div>
        </div>
        </div>
      </div>
  </div>
  
  <script src="/assets/plugins/jquery-ui/ui/widgets/datepicker.js"></script>
  <script src="/assets/plugins/jquery.maskedinput/jquery.maskedinput.js"></script>
  <script src="/assets/plugins/clipboard/clipboard.min.js"></script>
  <script src="/assets/plugins/clipboard/clipboard.js"></script>
  <script src="/assets/plugins/prism/prism.js"></script>
  <script src="/assets/js/tooltip.js"></script>
  <script src="/assets/js/select2.js"></script>




  <script>

$("#input_search").keyup(function(){
		var texto = $(this).val();

		$(".lista_processos .teteu_e_o_brabo").css("display", "block");

		$(".lista_processos .teteu_e_o_brabo").each(function(){
			if($(this).text().toUpperCase().indexOf(texto.toUpperCase()) < 0)
			   $(this).css("display", "none");
		});
	});



$(document).on('submit', '#form_pesquisa', function(e){
  e.preventDefault()
  $('.btn_filtro').text('Filtrando')
// var opcoes = $(this).serialize();

var opcoes = {
  tipo_filtro:$('input[name=tipo_filtro]:checked').val(),
  data_de:$('input[name=data_de]').val(),
  data_ate:$('input[name=data_ate]').val(),
  referencia:$('select[name=referencia]').val(),
  origem:$('select[name=origem]').val(),
  armador:$('select[name=armador]').val(),
  destino:$('select[name=destino]').val(),
  importador:$('select[name=importador]').val(),
  navio_viagem:$('select[name=navio_viagem]').val(),
  exportador:$('select[name=exportador]').val(),
  status:$('select[name=status]').val(),
  mercadoria:$('select[name=mercadoria]').val(),
  equipamento:$('select[name=equipamento]').val(),
  hbl:$('select[name=hbl]').val(),
  booking:$('select[name=booking]').val(),
}


  $.ajax({
          url : "/headrcargo_filtros",
          type : 'get',
          data : {
            opcoes : opcoes,
            empresa : db_local.empresa
          },
          dataType: "json",
          beforeSend : function(){
          }
      }).done(function(msg){
        
        $('.lista_processos').html('')
        // $('.btn_filtro').html('')
          $('.btn_filtro').html('<i class="fe fe-search"></i>')
        msg.forEach(element => {
          

          if(element.Situacao_Embarque_Codigo == 0){
          situacao = 'Pré-processo';
        }else if(element.Situacao_Embarque_Codigo == 1){
          situacao = 'Ag. embarque';
        }else if(element.Situacao_Embarque_Codigo == 2){
          situacao = 'Embarcado';
        }else if(element.Situacao_Embarque_Codigo == 3){
          situacao = 'Desembarque';
        }else if(element.Situacao_Embarque_Codigo == 4){
          situacao = 'Cancelado';
        }else if(element.Situacao_Embarque_Codigo == 5){
          situacao = 'Pendente';
        }else if(element.Situacao_Embarque_Codigo == 6){
          situacao = 'Autorizado';
        }else if(element.Situacao_Embarque_Codigo == 7){
          situacao = 'Coletado';
        }else if(element.Situacao_Embarque_Codigo == 8){
          situacao = 'Entregue';
        }else if(element.Situacao_Embarque_Codigo == 9){
          situacao = 'Ag. prontidão';
        }else if(element.Situacao_Embarque_Codigo == 10){
          situacao = 'Ag. booking finalizado';
        }else if(element.Situacao_Embarque_Codigo == 11){
          situacao = 'Ag. coleta';
        }else if(element.Situacao_Embarque_Codigo == 12){
          situacao = 'Ag. entrega';
        }else{
          situacao = element.Situacao_Embarque_Codigo;
        }



          var campo = '<a href="#" id="'+element.Numero_Processo+'" class="teteu_e_o_brabo list-group-item list-group-item-action flex-column align-items-start border-0">';
            campo += '<div class="d-flex w-100 justify-content-between">';
            campo += '<h6 class="mb-1 font-weight-bold">'+element.Numero_Processo+'</h6>';
            campo += '<h6 class="mb-0 font-weight-semibold tx-15" data-placement="top" data-toggle="tooltip" title="Data de Abertura">'+element.Data_Abertura+'</h6>';
            campo += '</div>';
            campo += '<div class="d-flex w-100 justify-content-between">';
            campo += '<span class="text-muted">';
            campo += '<i class="ti-alarm-clock  text-danger "></i> '+situacao+'</span>';
            campo += '<span class="text-muted tx-11">'+element.Rota+'</span>';
            campo += '</div>';
            campo += '</a>';

            $('.lista_processos').append(campo)
        });

        $('[data-toggle="tooltip"]').tooltip()







      })

})






      $('.data_mask').mask('99/99/9999');



    db_local = JSON.parse(localStorage.getItem("info_users_plataforma"))[0];


    


    $.ajax({
          url : "/headrcargo_criar_filtros",
          type : 'get',
          data : {
              empresa : db_local['empresa']
          },
          dataType: "json",
          beforeSend : function(){
          }
      }).done(function(msg){

msg.Referencia.forEach(element => {
  option = '<option value="'+element+'" >'+element+'</option>';
  $("#form_pesquisa select[name=referencia]").append(option); 
});

msg.Destino_Final.forEach(element => {
  option = '<option value="'+element+'" >'+element+'</option>';
  $("#form_pesquisa select[name=destino]").append(option); 
});

msg.Origem.forEach(element => {
  option = '<option value="'+element+'" >'+element+'</option>';
  $("#form_pesquisa select[name=origem]").append(option); 
});

msg.Cia_Transporte.forEach(element => {
  option = '<option value="'+element+'">'+element+'</option>';
  $("#form_pesquisa select[name=armador]").append(option); 
});


msg.House.forEach(element => {
  option = '<option value="'+element+'" >'+element+'</option>';
  $("#form_pesquisa select[name=hbl]").append(option); 
});


msg.Mercadoria.forEach(element => {
  option = '<option value="'+element+'" >'+element+'</option>';
  $("#form_pesquisa select[name=mercadoria]").append(option); 
});



msg.Viagem_Navio.forEach(element => {
  option = '<option value="'+element+'" >'+element+'</option>';
  $("#form_pesquisa select[name=navio_viagem]").append(option); 
});


msg.Numero_Reserva.forEach(element => {
  option = '<option value="'+element+'" >'+element+'</option>';
  $("#form_pesquisa select[name=booking]").append(option); 
});

msg.Importador.forEach(element => {
  option = '<option value="'+element+'" >'+element+'</option>';
  $("#form_pesquisa select[name=importador]").append(option); 
});

msg.Exportador.forEach(element => {
  option = '<option value="'+element+'" >'+element+'</option>';
  $("#form_pesquisa select[name=exportador]").append(option); 
});

msg.Equipamento.forEach(element => {
  option = '<option value="'+element+'" >'+element+'</option>';
  $("#form_pesquisa select[name=equipamento]").append(option); 
});








carrega_processos()

      })

      
function carrega_processos(){
  $.ajax({
          url : "/headcargo_api_all",
          type : 'get',
          data : {
              ref : db_local['empresa'],
              tipo : 'cliente'
          },
          dataType: "json",
          beforeSend : function(){
          }
      })
      .done(function(msg){
    

        $('.lista_processos').html('')
        msg.forEach(element => {

          if(element.Situacao_Embarque_Codigo == 0){
          situacao = 'Pré-processo';
        }else if(element.Situacao_Embarque_Codigo == 1){
          situacao = 'Ag. embarque';
        }else if(element.Situacao_Embarque_Codigo == 2){
          situacao = 'Embarcado';
        }else if(element.Situacao_Embarque_Codigo == 3){
          situacao = 'Desembarque';
        }else if(element.Situacao_Embarque_Codigo == 4){
          situacao = 'Cancelado';
        }else if(element.Situacao_Embarque_Codigo == 5){
          situacao = 'Pendente';
        }else if(element.Situacao_Embarque_Codigo == 6){
          situacao = 'Autorizado';
        }else if(element.Situacao_Embarque_Codigo == 7){
          situacao = 'Coletado';
        }else if(element.Situacao_Embarque_Codigo == 8){
          situacao = 'Entregue';
        }else if(element.Situacao_Embarque_Codigo == 9){
          situacao = 'Ag. prontidão';
        }else if(element.Situacao_Embarque_Codigo == 10){
          situacao = 'Ag. booking finalizado';
        }else if(element.Situacao_Embarque_Codigo == 11){
          situacao = 'Ag. coleta';
        }else if(element.Situacao_Embarque_Codigo == 12){
          situacao = 'Ag. entrega';
        }else{
          situacao = element.Situacao_Embarque_Codigo;
        }



          var campo = '<a href="#" id="'+element.Numero_Processo+'" class="teteu_e_o_brabo list-group-item list-group-item-action flex-column align-items-start border-0">';
            campo += '<div class="d-flex w-100 justify-content-between">';
            campo += '<h6 class="mb-1 font-weight-bold">'+element.Numero_Processo+'</h6>';
            campo += '<h6 class="mb-0 font-weight-semibold tx-15" data-placement="top" data-toggle="tooltip" title="Data de Abertura">'+element.Data_Abertura+'</h6>';
            campo += '</div>';
            campo += '<div class="d-flex w-100 justify-content-between">';
            campo += '<span class="text-muted">';
            campo += '<i class="ti-alarm-clock  text-danger "></i> '+situacao+'</span>';
            campo += '<span class="text-muted tx-11">'+element.Rota+'</span>';
            campo += '</div>';
            campo += '</a>';

            $('.lista_processos').append(campo)
        });

        $('[data-toggle="tooltip"]').tooltip()
        
      })
}

     
  </script>